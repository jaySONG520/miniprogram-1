<view class="study-page">
  <!-- 顶部：轮次与进度 -->
  <view class="study-header">
    <view class="round-text">
      {{round === 1 ? '第一轮 · 认义' : (round === 2 ? '第二轮 · 识形' : '第三轮 · 回想')}}
    </view>
    <progress class="study-progress" percent="{{progressPercent}}" active activeColor="#A8B5A0" border-radius="8" />
    <view class="progress-info">
      {{currentWordIndex + 1}} / {{totalWords}}
    </view>
  </view>

  <!-- 中间：学习卡片 -->
  <view class="study-card">
    <!-- 非详情态：按轮次展示不同交互 -->
    <view wx:if="{{!showDetail}}">
      <!-- 第一轮：选择中文释义 -->
      <view wx:if="{{round === 1}}">
        <view class="study-word">{{currentWord.word}}</view>
        <view class="study-phonetic">{{currentWord.phonetic}}</view>
        <view class="study-tip">选择与该单词最贴近的中文释义</view>
        <view class="options-group">
          <button
            wx:for="{{currentOptions}}"
            wx:key="*this"
            class="option-btn"
            bindtap="handleOptionTap"
            data-option="{{item}}"
          >
            {{item}}
          </button>
        </view>
      </view>

      <!-- 第二轮：认识 / 不认识 -->
      <view wx:elif="{{round === 2}}">
        <view class="study-word">{{currentWord.word}}</view>
        <view class="study-phonetic">{{currentWord.phonetic}}</view>
        <view class="study-tip">还记得这个单词的意思吗？</view>
        <view class="yn-group">
          <button class="yn-btn yes" bindtap="handleKnow">认识</button>
          <button class="yn-btn no" bindtap="handleDontKnow">不认识</button>
        </view>
      </view>

      <!-- 第三轮：根据中文回想英文 -->
      <view wx:else>
        <view class="study-meaning">{{currentWord.meaning}}</view>
        <view class="study-tip">看到中文，你还能想起这个英文单词吗？</view>
        <view class="yn-group">
          <button class="yn-btn yes" bindtap="handleRecall">想起来了</button>
          <button class="yn-btn no" bindtap="handleDontRecall">没想起</button>
        </view>
      </view>
    </view>

    <!-- 详情态：统一展示完整信息 -->
    <view wx:else>
      <view class="detail-word">{{currentWord.word}}</view>
      <view class="detail-phonetic">{{currentWord.phonetic}}</view>
      <view class="detail-meaning">{{currentWord.meaning}}</view>
      <view class="detail-example">
        <view class="detail-example-en">{{currentWord.example}}</view>
        <view class="detail-example-zh">{{currentWord.exampleMeaning}}</view>
      </view>
      <view class="detail-tip">
        {{lastAnswerCorrect ? '很好，继续下一步吧。' : '没关系，再一起温柔地记一次。'}}
      </view>
      <button class="next-btn" bindtap="handleNextFromDetail">
        {{isSessionFinished ? '本组完成' : '下一个'}}
      </button>
    </view>
  </view>
</view>


